
<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}LiteSpeedJobs{% endblock %}</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">


    <style>
        /* =========================================
        LiteSpeedJobs Professional Dark Theme
        ========================================= */
        :root {
            /* LIGHT MODE COLORS */
            --ls-bg: #ffffff;
            --ls-bg-card: #f7f9fc;
            --ls-text: #141414;
            --ls-text-muted: #555;
            --ls-border: #e4e7ec;

            --ls-icon-color: #f1f3f5;

            --chat-bg: #ffffff;
            --chat-panel-bg: #f8f9fa;
            --chat-border: #dee2e6;
            --chat-text: #212529;
            --chat-muted: #6c757d;

            --bubble-sent-bg: #0d6efd;
            --bubble-sent-text: #ffffff;

            --bubble-received-bg: #e9ecef;
            --bubble-received-text: #212529;

            /* BRAND COLOR */
            --ls-primary: #4dabf7;

            /* DARK MODE COLORS */
            --ls-dark-bg: #0e1116;
            --ls-dark-bg-card: #1a1d24;
            --ls-dark-border: #2b2e36;
            --ls-dark-text: #f1f3f7;
            --ls-dark-muted: #b7bcc7;
        }

        /* Smooth mode switching */
        body {
            transition: background 0.3s ease, color 0.3s ease;
        }

        /* ===========================
        DARK MODE BASE STYLING
        =========================== */
        body.dark-mode {
            
            background-color: var(--ls-dark-bg);
            color: var(--ls-dark-text);
            /* Rebind global variables */
            --ls-bg: var(--ls-dark-bg);
            --ls-bg-card: var(--ls-dark-bg-card);
            --ls-border: var(--ls-dark-border);
            --ls-text: var(--ls-dark-text);
            --ls-text-muted: var(--ls-dark-muted);
            --chat-bg: #0f172a;              /* deep slate */
            --chat-panel-bg: #020617;        /* almost black */
            --chat-border: #1e293b;
            --chat-text: #e5e7eb;
            --chat-muted: #94a3b8;

            --bubble-sent-bg: #2563eb;
            --bubble-sent-text: #ffffff;

            --bubble-received-bg: #1e293b;
            --bubble-received-text: #e5e7eb;

            
        }

        body.dark-mode h1,
        body.dark-mode h2,
        body.dark-mode h3,
        body.dark-mode h4,
        body.dark-mode h5 {
            color: var(--ls-dark-text);
        }
        body.dark-mode a,
        body.dark-mode p,
        body.dark-mode span,
        body.dark-mode label,
        body.dark-mode small {
            color: var(--ls-dark-muted);
        }

        /* ===========================
        NAVBAR
        =========================== */
        .navbar {
            
            transition: background 0.3s ease;
        }

        body.dark-mode .navbar {
            background-color: #14171d !important;
            border-bottom: 1px solid var(--ls-dark-border);
        }

        /* ===========================
        CARDS
        =========================== */
        .card {
            transition: background 0.3s ease, border 0.3s ease;
        }

        body.dark-mode .card {
            background-color: var(--ls-dark-bg-card) !important;
            border-color: var(--ls-dark-border) !important;
        }

        /* ===========================
        LIST ITEMS
        =========================== */
        body.dark-mode .list-group-item {
            background-color: var(--ls-dark-bg-card) !important;
            border-color: var(--ls-dark-border) !important;
            color: var(--ls-dark-text) !important;
        }

        /* ===========================
        FORMS + INPUTS
        =========================== */
        body.dark-mode .form-control,
        body.dark-mode textarea,
        body.dark-mode select,
        body.dark-mode input {
            background-color: #1b1e25 !important;
            border-color: var(--ls-dark-border) !important;
            color: var(--ls-dark-text) !important;
        }

        body.dark-mode .form-control:focus {
            border-color: var(--ls-primary) !important;
            box-shadow: 0 0 0 0.2rem rgba(77, 171, 247, 0.3) !important;
        }

        /* ===========================
        BUTTONS
        =========================== */
        .btn {
            transition: background 0.25s ease, color 0.25s ease, border 0.25s ease;
        }

        /* Primary */
        body.dark-mode .btn-primary {
            background-color: var(--ls-primary) !important;
            border-color: var(--ls-primary) !important;
            color: #000 !important;
        }

        /* Outline primary */
        body.dark-mode .btn-outline-primary {
            border-color: var(--ls-primary) !important;
            color: var(--ls-primary) !important;
        }
        body.dark-mode .btn-outline-primary:hover {
            background-color: var(--ls-primary) !important;
            color: #000 !important;
        }

        /* Danger */
        body.dark-mode .btn-outline-danger {
            border-color: #ff6b6b !important;
            color: #ff6b6b !important;
        }
        body.dark-mode .btn-outline-danger:hover {
            background-color: #ff6b6b !important;
            color: #000 !important;
        }

        .navbar .nav-link i,
        .navbar .inbox-icon {
            color: var(--ls-icon-color) !important;
            transition: color 0.2s ease;
        }

        .user-link .nav-icon,
        .user-link span {
            color: var(--ls-icon-color);
            transition: color 0.2s ease;
            font-weight: 500;
        }

        .user-link:hover .nav-icon,
        .user-link:hover span {
            color: var(--ls-primary);
            text-decoration: none;
        }

        .home-link,
        .home-link i {
            color: #ffffff !important;
        }

        .home-link:hover,
        .home-link:hover i {
            color: #ffffff !important;
        }

        .settings-link .nav-icon {
            color: #ffffff !important;
        }

        .bi-gear-fill {
            transition: transform 0.3s ease;
        }

        .bi-gear-fill:hover {
            transform: rotate(90deg);
        }
        .message-meta {
            color: var(--ls-text-muted);
        }

        body.dark-mode .message-meta {
            color: var(--ls-dark-muted);
        }

        

        /* ===========================
        ALERTS
        =========================== */
        body.dark-mode .alert {
            background-color: #1d2027 !important;
            border-color: var(--ls-dark-border) !important;
            color: var(--ls-dark-text) !important;
        }

        /* ===========================
        TABLES
        =========================== */
        body.dark-mode table {
            color: var(--ls-dark-text) !important;
        }

        body.dark-mode thead {
            background-color: #252933 !important;
        }

        body.dark-mode tbody tr {
            border-color: var(--ls-dark-border) !important;
        }

        body.dark-mode tbody tr:hover {
            background-color: #2a2e38 !important;
        }

        /* ===========================
        DARK MODE TOGGLE BUTTON
        =========================== */
        #darkModeToggle {
            font-size: 0.9rem;
            border-radius: 25px;
            padding: 5px 14px;
            cursor: pointer;
        }

        body.dark-mode #darkModeToggle {
            background-color: var(--ls-primary) !important;
            color: #000 !important;
            border-color: var(--ls-primary) !important;
        }

        /* Messaging layout */
        
        .inbox-container {
            background: var(--chat-bg);
            border: 1px solid var(--chat-border);
        }

        .conversation-list {
            background: var(--chat-panel-bg);
            border-right: 1px solid var(--chat-border);
        }

        .chat-window {
            background: var(--chat-bg);
            color: var(--chat-text);
        }

        .chat-messages {
            background: var(--chat-bg);
            color: var(--chat-text);
        }

        /* Conversation item */
        .conversation-item {
            background-color: transparent;
            color: var(--ls-text);
        }

        .conversation-item:hover {
            background-color: rgba(77, 171, 247, 0.12);
        }

        body.dark-mode .conversation-item:hover {
            background-color: rgba(255, 255, 255, 0.06);
        }

        .conversation-item.active {
            background-color: rgba(77, 171, 247, 0.18);
        }

        

        /* Message bubbles */
        

        body.dark-mode .message-bubble.sent {
            background-color: #60a5fa;
            color: #020617;
        }

        

        /* Input area */
        
        .chat-window a {
            color: #4dabf7;
        }

        body.dark-mode .chat-window a {
            color: #93c5fd;
        }

        .message-bubble {
            max-width: 75%;
            padding: 10px 14px;
            margin-bottom: 12px;
            border-radius: 14px;
            font-size: 0.95rem;
            line-height: 1.4;
        }

        .message-bubble.sent {
            background: var(--bubble-sent-bg);
            color: var(--bubble-sent-text);
            margin-left: auto;
        }

        .message-bubble.received {
            background: var(--bubble-received-bg);
            color: var(--bubble-received-text);
            border: 1px solid var(--chat-border);
        }
        .message-bubble small {
            color: var(--ls-dark-muted);
        }

        .message-bubble small {
            color: var(--chat-muted);
        }
        .btn-unlock {
        color: #111 !important;
        font-weight: 600;
        }

        /* Keep it dark on hover/focus too */
        .btn-unlock:hover,
        .btn-unlock:focus {
        color: #111 !important;
        }

        /* If you use icons inside */
        .btn-unlock i {
        color: #111 !important;
        }

        </style>

        <!-- <style>
        :root {
            --ls-bg-dark: #0f1217;
            --ls-bg-card: #1c1f26;
            --ls-text-light: #f2f5f8;
            --ls-text-muted: #c3c7cf;
            --ls-primary: #4dabf7;
            --ls-border: #2c2f36;
        }

        body.dark-mode {
            background-color: var(--ls-bg-dark);
            color: var(--ls-text-light);
        }

        body.dark-mode .card {
            background-color: var(--ls-bg-card) !important;
            color: var(--ls-text-light) !important;
            border-color: var(--ls-border) !important;
        }

        body.dark-mode .list-group-item {
            background-color: var(--ls-bg-card) !important;
            border-color: var(--ls-border) !important;
            color: var(--ls-text-light) !important;
        }

        body.dark-mode h1, 
        body.dark-mode h2, 
        body.dark-mode h3, 
        body.dark-mode h4, 
        body.dark-mode h5 {
            color: var(--ls-text-light) !important;
        }

        body.dark-mode p, 
        body.dark-mode span,
        body.dark-mode label {
            color: var(--ls-text-muted) !important;
        }

        body.dark-mode .navbar,
        body.dark-mode .navbar-dark {
            background-color: #14171c !important;
        }

        body.dark-mode .btn-primary {
            background-color: var(--ls-primary) !important;
            border-color: var(--ls-primary) !important;
            color: #000 !important;
        }

        body.dark-mode .btn-outline-primary {
            border-color: var(--ls-primary) !important;
            color: var(--ls-primary) !important;
        }

        body.dark-mode .form-control,
        body.dark-mode input,
        body.dark-mode textarea,
        body.dark-mode select {
            background-color: #1a1d23 !important;
            color: var(--ls-text-light) !important;
            border-color: var(--ls-border) !important;
        }

        body.dark-mode .alert {
            background-color: #1f2229 !important;
            border-color: var(--ls-border) !important;
            color: var(--ls-text-light) !important;
        }
    

    
        :root {
            --bg-color: #ffffff;
            --text-color: #000000;
            --card-bg: #ffffff;
            --border-color: #dddddd;
        }

        [data-theme="dark"] {
            --bg-color: #121212;
            --text-color: #ffffff;
            --card-bg: #1f1f1f;
            --border-color: #333333;
        }

        body {
            background-color: var(--bg-color);
            color: var(--text-color);
        }

        .card {
            background-color: var(--card-bg);
            border-color: var(--border-color) !important;
        }

        .navbar-dark-mode {
            cursor: pointer;
        }
    </style> -->
</head>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const toggle = document.getElementById("darkModeToggle");
    const body = document.body;

    // Load stored preference
    if (localStorage.getItem("ls-dark-mode") === "true") {
        body.classList.add("dark-mode");
    }

    toggle.addEventListener("click", () => {
        body.classList.toggle("dark-mode");
        localStorage.setItem("ls-dark-mode", body.classList.contains("dark-mode"));
    });
});
</script>


<body>
{% load message_tags %}
<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3">
    <a class="navbar-brand" href="/">LiteSpeedJobs</a>

    <div class="ms-auto d-flex align-items-center">

        <!-- Dark Mode Toggle -->
        <button id="darkModeToggle" class="btn btn-outline-light ms-3">
            ðŸŒ™ Dark Mode
        </button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

        
        <li class="nav-item">
            <a class="nav-link d-flex align-items-center home-link"
            href="{% url 'landing' %}">
                <i class="bi bi-house-door-fill me-1 nav-icon"></i>
                <span class="d-none d-md-inline">Home</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </a>
        </li>
        {% if user.is_authenticated %}
        
        <a href="{% url 'inbox_pro' %}" class="nav-link d-flex align-items-center home-link">Inbox</a>&nbsp;&nbsp;&nbsp;
        
        <a href="{% url 'inbox_pro' %}" class="nav-link position-relative">
            <i class="bi bi-inbox"></i>

            {% if unread_count and unread_count > 0 %}
                <span id="unreadBadge"
                    class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    {{ unread_count }}
                </span>
            {% endif %}
        </a>

        
        </li>
        {% else %}
        <li class="nav-item">
            <a href="{% url 'login' %}" class="nav-link">
                <i class="bi bi-inbox"></i>
            </a>
        </li>
        {% endif %}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

        <hr>
        {% if request.user.is_authenticated %}
            <a href="{% url 'role_redirect' %}"
                class="nav-link d-flex align-items-center gap-1 user-link">

                <i class="bi bi-person-circle nav-icon fs-5"></i>
             <span class="d-none d-md-inline">
                 <strong>{{ request.user.username }}</strong>&nbsp;&nbsp;&nbsp;&nbsp;
            </span>
            
            
        {% endif %}
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle p-0"
            href="#"
            id="settingsDropdown"
            role="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            data-bs-placement="bottom"
            title="Account settings">
                <i class="bi bi-gear-fill fs-5 text-white"></i>
            </a>

            <ul class="dropdown-menu dropdown-menu-end shadow" style="background-color: #000; color: white;"
                aria-labelledby="settingsDropdown">

                <li>
                    <a class="dropdown-item" href="{% url 'account_settings' %}">
                        <i class="bi bi-person-gear me-2"></i> Account Settings
                    </a>
                </li>

                <li><hr class="dropdown-divider"></li>

                <li>
                    <a class="dropdown-item text-danger"
                    href="{% url 'logout' %}">
                        <i class="bi bi-box-arrow-right me-2"></i> Logout
                    </a>
                </li>
            </ul>
        </li>
        

    </div>
</nav>

<div class="container py-4">
    {% block content %}{% endblock %}
</div>
{% if messages %}
<div class="container mt-3">
    {% for message in messages %}
        <div class="alert alert-{{ message.tags }} mb-2">
            {{ message }}
        </div>
    {% endfor %}
</div>
{% endif %}
<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- Dark Mode Script -->
<script>
    const root = document.documentElement;
    const toggle = document.querySelector('.navbar-dark-mode');

    // Load saved preference
    if (localStorage.getItem('theme') === 'dark') {
        root.setAttribute('data-theme', 'dark');
    }

    toggle.addEventListener('click', () => {
        let current = root.getAttribute('data-theme');
        let next = current === 'light' ? 'dark' : 'light';
        root.setAttribute('data-theme', next);
        localStorage.setItem('theme', next);
    });
</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    const badge = document.getElementById("inboxBadge");
    if (!badge) return;

    fetch("{% url 'unread_count_api' %}", {
        headers: {
            "X-Requested-With": "XMLHttpRequest"
        }
    })
    .then(res => res.json())
    .then(data => {
        if (data.count > 0) {
            badge.textContent = data.count;
            badge.classList.remove("d-none");
        } else {
            badge.classList.add("d-none");
        }
    })
    .catch(err => {
        console.error("Unread count fetch failed", err);
    });
});
</script>

</body>
</html>
